[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=120
PauseHotkeyMod=0
StopHotkey=119
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=de883e72-677b-4ece-9c97-a10d4fc471d5
Description=Beta_Version
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]

//********************************************************************Initialization********************************************************************

//Dim ID1 for reset Main thread
Dimenv ID1

//battle toggle  
Dimenv Initial, Resupply, Echelon, ElfOrder
Initial = True
Resupply = False
ElfOrder = False

//subTask toggle
Dimenv CollectBattery,SimulateBattle
CollectBattery = True
SimulateBattle = True

//for reset program
Dimenv ReBound
ReBound = False

//Listener
DimEnv RepairTimes, Rounds, CompleteTimes, RestartTimes, stuckedProcess
RepairTimes = 0
Rounds = 0
CompleteTimes = 0
RestartTimes = 0

//Time Management
Dimenv MyHour, MyWeekDay, StartTime
MyWeekDay = Weekday(Date)
StartTime = Now

//register DM only at first time
//PutAttachment ".\plugin", "RegDll.dll"
//PutAttachment ".\plugin\dm", "dm.dll"
//Plugin.RegDll.Reg (Plugin.sys.GetDir(0) + "\plugin\dm\dm.dll")

//set DM plugin
Set dm = CreateObject("dm.dmsoft")

//hwnd begins at coordinate（171，68）
Dimenv hwnd
hwnd = dm.GetMousePointWindow()



//***********************************************************************Start Process***********************************************************************

ID1 = BeginThread(main)

BeginThread Unexpected

BeginThread StuckedReload

Call Listener

Sub OnThreadExit()
Set dm = CreateObject("dm.dmsoft")
dm_ret = dm.UnBindWindow()
End Sub



//********************************************************************Main Thread********************************************************************
//********************************************************************Main Thread********************************************************************
//********************************************************************Main Thread********************************************************************

Sub main

//set DM plugin
Set dm = CreateObject("dm.dmsoft")

//bind window
Call dmBD

Do

Call Combat 

Call Simulation

Call Battery

Loop

End Sub



//********************************************************************Assistant Thread*****************************************************************************
//********************************************************************Assistant Thread*****************************************************************************
//********************************************************************Assistant Thread*****************************************************************************

//******************************Listener******************************

Sub Listener

Do

Form1.Label1.Caption = Now

Form1.Label2.Caption = "Rounds : " & Rounds

Form1.Label3.Caption = runtime(StartTime)

Form1.Label4.Caption = "CompleteTimes : " & CompleteTimes

Form1.Label5.Caption = "RestartTimes : " & RestartTimes

Form1.Label6.Caption = "WeekDay : " & MyWeekDay - 1

Form1.Label7.Caption = "RepairTimes" & RepairTimes

MyHour = Hour(Now)

If MyHour = 2 Then 

CollectBattery = False

ElseIf MyHour = 5 Or MyHour = 11 Or MyHour = 17 Or MyHour = 23 Then

SimulateBattle = False

End If

Delay 1000

Loop

End Sub

Function runtime(StartTime)

Dim sec, min, hour
sec = 0
min = 0
hour = 0
sec = DateDiff("s", StartTime, Now)
hour = int(sec / 60 / 60)
min = int(sec / 60) - hour * 60
sec = sec - min * 60 - hour * 60 * 60

If hour = 0 and min = 0 Then 
runtime = "已运行 : " & sec & "秒"
ElseIf hour = 0 Then
runtime = "已运行 : " & min & "分" & sec & "秒"
ElseIf hour > 0 Then
runtime = "已运行 : " & hour & "小时"& min & "分" & sec & "秒"
End If

End Function

//*******************Use DM plugin to bind window*******************

Sub dmBD

Do
i = 0
dm_ret = dm.BindWindow(hwnd, "dx2", "dx", "dx", 0)
TracePrint dm_ret
TracePrint dm.GetLastError()
If dm_ret = 1 Then 	
i = 1
Delay 1000
Else 
dm_ret = dm.BindWindow(hwnd, "dx2", "dx", "dx", 0)
Delay 1000
End If
Delay 1000
Loop While i = 0

End Sub


//************************************************************StuckedReload************************************************************
//************************************************************StuckedReload************************************************************
//************************************************************StuckedReload************************************************************

Sub StuckedReload

Do

Dim a, b

a = CompleteTimes

TracePrint a

Delay 900000

b = CompleteTimes

TracePrint b

If a = b Then 

Form1.ListBox1.AddItem stuckedProcess

MyHour = Hour(Now)

If MyHour < 10 Then 
MoveTo 570, 50
LeftClick 1
Else
MessageBox "stucked!"
End If

stuckedProcess = "crashedReloading"

End If

Loop

End Sub

//************************************************************Unexpected************************************************************
//************************************************************Unexpected************************************************************
//************************************************************Unexpected************************************************************


Sub Unexpected

//avoid dmBD congestion
Delay 30000

Rem reBd

//set DM plugin
Set dm = CreateObject("dm.dmsoft")

//bind window
Call dmBD

Do

//CrashedReloading
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\少前.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 

StopThread (ID1)
Delay 3000

ReBound = True
Initial = True
Resupply = True
Rounds = 0
RestartTimes = RestartTimes + 1
Form1.ListBox1.AddItem Now

dm.MoveTo intX, intY
dm.LeftClick
Delay 9000

stuckedProcess = "reloading"

Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进入游戏.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
dm.MoveTo 165, 340
dm.LeftClick
Delay 15000
End If
Delay 500
Loop While i = 0

ID1 = BeginThread(main)

End If

Delay 500

//logistics support return
dm_ret = dm.FindPic( 0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\后勤回归.bmp","020202", 0.9,0, intX, intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick
Delay 1500
End If
Delay 500

//logistics support resend
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\再派遣确定.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick
Delay 1500
End If
Delay 500

//close achievement window
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\关闭成就.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 515, 405
dm.LeftClick
End If
Delay 500

//daily bonus
dm_ret = dm.FindPic(0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\每日奖励.bmp", "020202", 0.9, 0, intX, intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 100, 45
dm.LeftClick
Delay 9000
dm.MoveTo 100, 45
dm.LeftClick
Delay 6000
dm.MoveTo 525, 405
dm.LeftClick
Delay 3000
dm.MoveTo 60, 60
dm.LeftClick
Delay 3000
CompleteTimes = CompleteTimes + 1
End If
Delay 500

//full storehouse
dm_ret = dm.FindPic(0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\满仓.bmp", "020202", 0.9, 0, intX, intY)
If intX > 0 And intY > 0 Then 
MessageBox "快去强化"
End If
Delay 500

//restart rebound window
If ReBound = True Then 
ReBound = False
Delay 30000
Goto reBd
End If

Loop

End Sub


//************************************************************Main Thread subroutine*******************************************************************
//************************************************************Main Thread subroutine*******************************************************************
//************************************************************Main Thread subroutine*******************************************************************
//************************************************************Main Thread subroutine*******************************************************************
//************************************************************Main Thread subroutine*******************************************************************

//************************************************Combat************************************************
//************************************************Combat************************************************
//************************************************Combat************************************************

Sub Combat

//terminate combat while reset main thread
If reSupply = True Then 
Call EnterBattleField	
End If

If reSupply = True Or Form1.OptionBox2.Value = 1 Then 
Call Restore
End If

Call Retire

Call EnterBattleField

For 6

Rounds = Rounds + 1

If Form1.OptionBox1.Value = 1 Then 
Call Battle81N
ElseIf Form1.OptionBox2.Value = 1 Then
Call Battle02
End If

CompleteTimes = CompleteTimes + 1
Rounds = Rounds Mod 6

Next

Call ReturnToBase

End Sub


//**************************************************************Enter BattleField************************************************************
//**************************************************************Enter BattleField************************************************************
//**************************************************************Enter BattleField************************************************************


Sub EnterBattleField

stuckedProcess = "enter81n"

//Select Combat module
dm.MoveTo 680, 360
dm.LeftClick
Delay 4500

Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\战斗页面.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
dm.MoveTo 50, 110
dm.LeftClick
Delay 3000
Else 
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\基地.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 680, 360
dm.LeftClick
Delay 4500
End If
End If
Delay 500
Loop While i = 0


//81N
If Form1.OptionBox1.Value = 1 Then 

If Initial = True Then 

Rem reEnter81n

//select chapter 8
dm.MoveTo 205, 110
For 3
dm.WheelDown
Delay 500
Next
Delay 1500
dm.MoveTo 205, 230
dm.LeftClick
Delay 1500
End If

//select Night
dm.MoveTo 970, 152
dm.LeftClick
Delay 2000

//select 81N
dm.MoveTo 910, 230
dm.LeftClick
Delay 2000

//Confirm 81N
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\81n.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
dm.MoveTo 170, 70
dm.LeftClick
Delay 1500

Goto reEnter81n

End If
Delay 500

If Resupply = True Then 
//terminate combat

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\终止作战.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 390, 440
dm.LeftClick
Delay 3000
Else 
dm.MoveTo 170, 70
dm.LeftClick
Delay 1500
End If

Goto returnBase

End If

//Enter battlefield
dm.MoveTo 541, 435
dm.LeftClick
Delay 3000

//confirm enter
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

//scaling
If Initial = True Then 
Initial = False
dm.MoveTo 529, 295
dm.KeyDownChar "ctrl"
For 6
dm.WheelDown
Delay 1000
Next
dm.KeyUpChar "ctrl"
End If

//02
ElseIf Form1.OptionBox2.Value = 1 Then

If Initial = True Then 
Initial = False

Rem reEnter02

//select chapter 0
dm.MoveTo 175, 100
dm.LeftClick
Delay 1500
End If

//select 02
dm.MoveTo 580, 295
dm.LeftClick
Delay 1500

//confirm 02
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\02.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
Else 
dm.MoveTo 190, 75
dm.LeftClick
Delay 1000

Goto reEnter02

End If
Delay 500

If Resupply = True Then 
//terminate combat

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\终止作战.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 390, 440
dm.LeftClick
Delay 3000
Else 
dm.MoveTo 170, 70
dm.LeftClick
Delay 1500
End If

Goto returnBase

End If

//Enter battlefield
dm.MoveTo 540, 435
dm.LeftClick
Delay 5000

//confirm enter
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i=0

End If

Rem returnBase

If Resupply = True Then 

Call ReturnToBase
	
End If



End Sub




//****************************************************************Battle81N**************************************************************
//****************************************************************Battle81N**************************************************************
//****************************************************************Battle81N**************************************************************


Sub Battle81N

stuckedProcess = "EchelonDeploy"

Rem restart81n

Call EchelonDeploy(225, 85, 180, 430)

//*****************************Restart Resupply*********************************
If Resupply = True Then 
Resupply = False
//slide up map
dm.MoveTo 529,295
For 2
dm.WheelUp
Delay 500
Next
Delay 1500
//resupply at airport above
dm.MoveTo 196, 96
dm.LeftClick
Delay 500
dm.LeftClick
Delay 1500
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i=0
//resupply
dm.MoveTo 880, 430
dm.LeftClick
Delay 9000

//retreat
dm.MoveTo 196, 96
dm.LeftClick
Delay 1500
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0
dm.MoveTo 810, 510
dm.LeftClick
Delay 2000
dm.MoveTo 595, 395
dm.LeftClick
Delay 2000

//restart
dm.MoveTo 260, 30
dm.LeftClick
Delay 1500
dm.MoveTo 396, 386
dm.LeftClick
Delay 3000

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

Goto restart81n

End If

//*********************************Battle81N*******************************

stuckedProcess = "Battle81N"

//select plan
dm.MoveTo 50, 470
dm.LeftClick
Delay 500

//select echelon
dm.MoveTo 150, 445
dm.LeftClick
Delay 500

//select point
dm.MoveTo 235, 350
dm.LeftClick
Delay 500

dm.MoveTo 250, 235
dm.LeftClick
Delay 500

dm.MoveTo 125, 320
dm.LeftClick
Delay 500

dm.MoveTo 110, 175
dm.LeftClick
Delay 500

dm.MoveTo 260, 145
dm.LeftClick
Delay 500

//execute plan
dm.MoveTo 930, 505
dm.LeftClick
Delay 30000

//waiting battle
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\行动结束81n.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 1000
End If
Delay 500
Loop While i = 0

//supply at airport above 
dm.MoveTo 196, 96
dm.LeftClick
Delay 500
dm.LeftClick
Delay 1500
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i=0
//supply
dm.MoveTo 880, 430
dm.LeftClick
Delay 2000
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\行动结束81n.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 1000
End If
Delay 500
Loop While i = 0
//retreat
dm.MoveTo 196, 96
dm.LeftClick
Delay 1500
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0
dm.MoveTo 810, 510
dm.LeftClick
Delay 2000
dm.MoveTo 595, 395
dm.LeftClick
Delay 2000
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

//restart
dm.MoveTo 260, 30
dm.LeftClick
Delay 1500
dm.MoveTo 396, 386
dm.LeftClick
Delay 3000

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

End Sub



//****************************************************************Battle02**************************************************************
//****************************************************************Battle02**************************************************************
//****************************************************************Battle02**************************************************************


Sub Battle02

//confirm Elf Order
dm_ret = dm.FindPic( 0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\空指令.bmp","020202", 0.9,0, intX, intY)
If intX > 0 And intY > 0 Then 
ElfOrder = False
Else 
ElfOrder = True
End If

stuckedProcess =  "EchelonDeploy"

Rem restart02

Call EchelonDeploy(75, 280, 510, 280)


//*********************************Battle02*******************************

stuckedProcess = "Battle02"

//************************supply************************

//select airport left
dm.MoveTo 100, 270
dm.LeftClick
Delay 1000
dm.LeftClick
Delay 1000

//supply
dm.MoveTo 880, 430
dm.LeftClick
Delay 2000

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

Delay 2000

//***********************Restart Resupply***************************

If Resupply = True Then 
Resupply = False

//retreat
dm.MoveTo 100, 270
dm.LeftClick
Delay 1500
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0
dm.MoveTo 810, 510
dm.LeftClick
Delay 2000
dm.MoveTo 595, 395
dm.LeftClick
Delay 2000

//restart
dm.MoveTo 260, 30
dm.LeftClick
Delay 1500
dm.MoveTo 396, 386
dm.LeftClick
Delay 3000

//confirm EnterBattleField
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
dm.MoveTo 970, 25
dm.LeftClick
Delay 4500
End If
Delay 500
Loop While i = 0

Goto restart02

End If


//************************ELF ORDER************************

dm_ret = dm.FindPic( 0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\空指令.bmp","020202", 0.9,0, intX, intY)
If intX > 0 And intY > 0 Then 
ElfOrder = False
End If

If ElfOrder = True Then 
	
//select echelon at headquarters
dm.MoveTo 510, 280
dm.LeftClick
Delay 1000

//Elf Order
dm.MoveTo 970, 320
dm.LeftClick
Delay 1000
dm.MoveTo 510, 280
dm.LeftClick
Delay 2500

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

End If


//************************Execute plan************************

Rem replan

//select plan
dm.MoveTo 50, 470
dm.LeftClick
Delay 500

//confirm plan

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\计划on.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
Else 
Goto rePlan
End If

//select echelon
dm.MoveTo 510, 280
dm.LeftClick
Delay 500
//select point
dm.MoveTo 350, 180
dm.LeftClick
Delay 500

//slide up map
dm.MoveTo 800, 350
Delay 200
For 11
dm.WheelUp
Delay 500
Next

//select point
dm.MoveTo 370, 565
dm.LeftClick
Delay 500

dm.MoveTo 530, 380
dm.LeftClick
Delay 500

dm.MoveTo 380, 280
dm.LeftClick
Delay 500

//confirm plan

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\计划021.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
Else 

dm.MoveTo 800, 350
Delay 200
For 11
dm.WheelDown
Delay 500
Next

Goto replan
End If

//excute plan
dm.MoveTo 930, 505
dm.LeftClick
Delay 500


//end round one
Do
i=0

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\行动结束021.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 3000
dm.MoveTo 900, 510
dm.LeftClick
End If
Delay 500
Loop While i = 0

Delay 3000

//waiting
Do
i=0

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\回合开始02.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

Delay 6000


//************************Elf Order************************


dm_ret = dm.FindPic( 0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\空指令.bmp","020202", 0.9,0, intX, intY)
If intX > 0 And intY > 0 Then 
ElfOrder = False
End If

If ElfOrder = True Then

//select echelon
dm.MoveTo 520, 280
dm.LeftClick
Delay 1000

//Elf Order
dm.MoveTo 970, 320
dm.LeftClick
Delay 1000
dm.MoveTo 520, 280
dm.LeftClick
Delay 2500
End If

//select plan
dm.MoveTo 50, 470
dm.LeftClick
Delay 500

//select Echelon
dm.MoveTo 520, 280
dm.LeftClick
Delay 500

//confirm selection
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\0-2-3.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
dm.MoveTo 50, 470
dm.LeftClick
Delay 500
dm.MoveTo 520, 280
dm.LeftClick
Delay 500
End If
Delay 500
Loop While i=0

//select point
dm.MoveTo 810, 280
dm.LeftClick
Delay 500

dm.MoveTo 970, 315
dm.LeftClick
Delay 500

//execute plan
dm.MoveTo 930, 505
dm.LeftClick
Delay 500


//end round two
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\行动结束022.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 3000
dm.MoveTo 900, 510
dm.LeftClick 
End If
Delay 500
Loop While i = 0

//result
Delay 5000

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\结算S.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 2000
End If
Delay 500
Loop While i = 0

Delay 2000
dm.MoveTo 529, 295
dm.LeftClick
Delay 1500
dm.LeftClick
Delay 500
dm.LeftClick
Delay 500
dm.LeftClick
Delay 500


//************************repeat combat************************

Delay 9000

//select02
dm.MoveTo 580, 295
dm.LeftClick
Delay 1000

//confirm02
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\02.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
dm.MoveTo 190, 75
dm.LeftClick
Delay 1000
dm.MoveTo 590, 295
dm.LeftClick
Delay 1500
End If
Delay 500
Loop While i = 0

//EnterBattleField
dm.MoveTo 540, 435
dm.LeftClick
Delay 5000

//confirm enter
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
Else 
i=0
End If
Delay 500
Loop While i=0

End Sub


//***********************************************************************Preparation***************************************************************************
//***********************************************************************Preparation***************************************************************************
//***********************************************************************Preparation***************************************************************************

Sub EchelonDeploy(x, y, m, n)

//Echelon formation
dm.MoveTo x, y
dm.LeftClick
Delay 1000
Do
i = 0

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 1000
Loop While i = 0

dm.MoveTo 165, 485
dm.LeftClick
Delay 3000

//******************TeamExchange**********************

//waiting
Do
i=0

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\阵型预设.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0


//confirm echelon

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\选择角色.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
Echelon = 1
Else 
Echelon = 2
End If

If Echelon = 2 Then 
//select echelon 2
dm.MoveTo 90, 180
dm.LeftClick
Delay 1000
End If

//confirm selection
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\选择角色.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
dm.MoveTo 90, 180
dm.LeftClick
Delay 1000
End If
Delay 500
Loop While i = 0

//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\阵型预设.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0


//select ELF
dm.MoveTo 930, 230
dm.LeftClick
Delay 3000

If ElfOrder = True Then 
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\搜救妖精.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick 
Else 
dm.MoveTo 500, 175
dm.LeftClick 
End If
Else
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\护盾妖精.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick 
Else 
dm.MoveTo 640, 175
dm.LeftClick 
End If
End If

Delay 1000

//1.220,2.360,3.500,4.640,5.780


//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\阵型预设.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0

//select preset
dm.MoveTo 890, 505
dm.LeftClick
Delay 3000

//confirm preset
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\预设.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
//select preset
dm.MoveTo 890, 505
dm.LeftClick
Delay 3000
End If
Delay 500
Loop While i = 0

//select preset
dm.MoveTo 980, 195
dm.LeftClick
Delay 3000

If Echelon = 2 Then 
//select echelon 2
dm.MoveTo 610, 145
dm.LeftClick
Delay 1000
Else 
//select echelon 1
dm.MoveTo 610, 50
dm.LeftClick
Delay 1000
End If

//use preset
dm.MoveTo 890, 485
dm.LeftClick
Delay 1000

//confirm exchange
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\强制替换.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
Else 
dm.MoveTo 460, 330
dm.LeftClick
Delay 1000
End If

//confirm exchange
dm.MoveTo 635, 385
dm.LeftClick
Delay 1000

//confirm exchange
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\确定.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
dm.MoveTo 910, 490
dm.LeftClick
Delay 1000
End If
Delay 500
Loop While i=0

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\返回.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
dm.MoveTo 85, 50
dm.LeftClick
Delay 1000
End If
Delay 500
Loop While i = 0

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0
Delay 1000


//******************EchelonDeploy**********************


If Echelon = 2 Then 

//deploy echelon 1
dm.MoveTo x, y
dm.LeftClick
Delay 3000
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i=0
dm.MoveTo 930, 500
dm.LeftClick
Delay 2000
//deploy echelon 2
dm.MoveTo m, n
dm.LeftClick
Delay 3000
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i=0
dm.MoveTo 930, 500
dm.LeftClick
Delay 2000

Else 

//deploy echelon 1
dm.MoveTo m, n
dm.LeftClick
Delay 3000
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i=0
dm.MoveTo 930, 500
dm.LeftClick
Delay 2000
//deploy echelon 2
dm.MoveTo x, y
dm.LeftClick
Delay 3000
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\队伍编成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i=0
dm.MoveTo 930, 500
dm.LeftClick
Delay 2000

End If

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\进图完毕.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
End If
Delay 500
Loop While i = 0

//start battle
dm.MoveTo 810, 496
dm.LeftClick
Delay 3000

Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\回合开始01.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
dm.MoveTo 810, 496
dm.LeftClick
Delay 3000
End If
Delay 500
Loop While i = 0

End Sub




//*************************************************************Retire*************************************************************
//*************************************************************Retire*************************************************************
//*************************************************************Retire*************************************************************
Sub Retire

stuckedProcess = "dismantling"

Delay 1500
//factory
dm.MoveTo 855, 240
dm.LeftClick
Delay 4500
Do
i=0

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\工厂.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
Else 

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\基地.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 855, 240
dm.LeftClick
Delay 4500
End If
End If
Delay 500
Loop While i=0

//retire
dm.MoveTo 80, 360
dm.LeftClick
Delay 1500

If Form1.OptionBox1.Value = 1 Then 
//*****************************Select Weapon*************************
dm.MoveTo 430, 160
dm.LeftClick
Delay 1500

ElseIf Form1.OptionBox2.Value = 1 Then
//*******************************Select T-Dolls****************************
dm.MoveTo 255, 155
dm.LeftClick
Delay 1500
End If

//confirm inventory

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\没得休.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick
Delay 1500
Goto backbase
End If

//auto select
dm.MoveTo 930, 495
dm.LeftClick
Delay 3000
//confim
dm.MoveTo 930, 495
dm.LeftClick
Delay 1500
//retire
dm.LeftClick
Delay 3000

//retire high level
If Form1.OptionBox1.Value = 1 Then 
//*****************************Select Weapon*************************
dm.MoveTo 430, 160
dm.LeftClick
Delay 1500

ElseIf Form1.OptionBox2.Value = 1 Then
//*******************************Select T-Dolls****************************
dm.MoveTo 255, 155
dm.LeftClick
Delay 1500
End If

//confirm inventory

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\没得休.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick
Delay 1500
Goto backbase
End If

//reverse order
dm.MoveTo 910, 380
dm.LeftClick
Delay 1000
//select  
dm.MoveTo 105, 145
dm.LeftClick
Delay 200
For 5
dm.MoveR 140, 0
dm.LeftClick
Delay 200
Next
dm.MoveTo 105, 405
dm.LeftClick
Delay 200
For 5
dm.MoveR 140, 0
dm.LeftClick
Delay 200
Next
//confirm retire
dm.MoveTo 930, 495
dm.LeftClick
Delay 1500
dm.LeftClick
Delay 1500
//confirm
dm.MoveTo 600, 385
dm.LeftClick
Delay 3000

Rem backbase

Call ReturnToBase

End Sub


//*************************************************************Restore*************************************************************
//*************************************************************Restore*************************************************************
//*************************************************************Restore*************************************************************

Sub Restore

stuckedProcess = "repairing"

//repair
Delay 1000
dm.MoveTo 685, 155
dm.LeftClick
Delay 2000
//select T-dolls
Do
f=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\修复.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
f = 1
Else 

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\基地.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
Delay 1000
dm.MoveTo 685, 155
dm.LeftClick
Delay 2000
End If
End If
Delay 500
Loop While f = 0
//repair
Delay 1000
dm.MoveTo 555, 255
dm.LeftClick
Delay 3000
//confirm

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\没得休.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo intX, intY
dm.LeftClick
Delay 1500
Goto backhome
End If
//select T-dolls
dm.MoveTo 80, 180
dm.LeftClick
Delay 100
dm.MoveTo 215, 180
dm.LeftClick
Delay 100
dm.MoveTo 350, 180
dm.LeftClick
Delay 100
dm.MoveTo 485, 180
dm.LeftClick
Delay 100
//confim
dm.MoveTo 940, 440
Delay 100
dm.LeftClick
Delay 1000
dm.MoveTo 255, 405
Delay 100
dm.LeftClick
Delay 500
dm.MoveTo 760, 400
Delay 500
dm.LeftClick
Delay 1000
//repair complete
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\修复完成.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i=1
dm.MoveTo 510, 410
Delay 500
dm.LeftClick
Delay 500
End If
Delay 500
Loop While i = 0

RepairTimes = RepairTimes + 1

Rem backhome

Call ReturnToBase

End Sub

//*************************************************************ReturnToBase*************************************************************
//*************************************************************ReturnToBase*************************************************************
//*************************************************************ReturnToBase*************************************************************
Sub ReturnToBase

Delay 1500
dm.MoveTo 65, 30
dm.LeftClick
Delay 6000
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\基地.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Else 
dm.MoveTo 65, 30
dm.LeftClick	
Delay 6000

dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\狗牌.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
dm.MoveTo 529, 295
dm.LeftClick	
Delay 6000
End If
End If
Delay 500
Loop While i = 0
End Sub



//*************************************************************************Other Task*******************************************************************************
//*************************************************************************Other Task*******************************************************************************
//*************************************************************************Other Task*******************************************************************************
//*************************************************************************Other Task*******************************************************************************
//*************************************************************************Other Task*******************************************************************************


//*************************************************************Battery*************************************************************
//*************************************************************Battery*************************************************************
//*************************************************************Battery*************************************************************

Sub Battery

If CollectBattery = False And MyHour = 3 Then 

//select friend
dm.MoveTo 890, 530
dm.LeftClick
Delay 3000
//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\好友.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 2000
End If
Delay 500
Loop While i = 0
//order by level
dm.MoveTo 780, 130
dm.LeftClick
Delay 1000
dm.MoveTo 930, 310
dm.LeftClick
Delay 1000
//enter dormitory
dm.MoveTo 160, 210
dm.LeftClick
Delay 1000
//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\名片.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0
dm.MoveTo 760, 480
dm.LeftClick
Delay 3000
//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\返回宿舍.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0
//collect battery
For 12
dm.MoveTo 270, 340
dm.LeftClick
Delay 1000
dm.MoveTo 530, 410
dm.LeftClick
Delay 1000
dm.MoveTo 920, 530
dm.LeftClick
Delay 1000
dm.MoveTo 195, 515
dm.LeftClick
Delay 6000
//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\返回宿舍.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0
Next

Call ReturnToBase

CollectBattery = True

End If

CompleteTimes = CompleteTimes + 1

End Sub

//*************************************************************Simulation*************************************************************
//*************************************************************Simulation*************************************************************
//*************************************************************Simulation*************************************************************

Sub Simulation


If MyHour = 3 Or MyHour = 9 Or MyHour = 15 or MyHour = 21 And SimulateBattle = False Then 

//select combat module
dm.MoveTo 680, 360
dm.LeftClick
Delay 4500

//select simulation
Do
i = 0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\战斗页面.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
dm.MoveTo 80, 265
dm.LeftClick
Delay 1000
Else 
dm.MoveTo 680, 360
dm.LeftClick
Delay 4500
End If
Delay 500
Loop While i = 0

//Weekday(Date)==（361） for skill data
MyWeekDay = Weekday(Date)
If MyWeekDay = 3 or MyWeekDay = 6 or MyWeekDay = 1 Then 
//skill data 
dm.MoveTo 200, 200
dm.LeftClick
Delay 1000

//middle level
dm.MoveTo 605, 320
dm.LeftClick
Delay 1000

//enter battle
dm.MoveTo 720, 450
dm.LeftClick
Delay 1000
//confirm
dm.MoveTo 600, 400
dm.LeftClick
Delay 15000
//waitting
dm.LeftClick
Delay 9000

Call ReturnToBase

//Weekday(Date) ！==（361） for mind update data
Else 
/// mind update data
dm.MoveTo 205, 370
dm.LeftClick
Delay 1000
//high level
dm.MoveTo 605, 415
dm.LeftClick
Delay 1000
//waiting
Do
i=0
dm_ret = dm.FindPic(0, 0, 1366, 768, "D:\按键精灵\按键精灵2014\screen\任务选择.bmp", "020202", 0.9, 0, intX, intY)
If intX > 0 And intY > 0 Then 
i = 1
End If
Delay 500
Loop While i = 0

//scaling
dm.MoveTo 529, 295
dm.KeyDownChar "ctrl"
For 6
dm.WheelDown
Delay 1000
Next
dm.KeyUpChar "ctrl"

//select airport
dm.MoveTo 500, 375
dm.LeftClick
Delay 1000
//select echelon 3
dm.MoveTo 80, 360
dm.LeftClick
Delay 1000
//confirm
dm.MoveTo 910, 500
dm.LeftClick
Delay 1000
//start battle
dm.MoveTo 910, 500
dm.LeftClick
Delay 1000
//confirm
dm.MoveTo 600, 380
dm.LeftClick
Delay 6000
//select plan
dm.MoveTo 80, 460
dm.LeftClick
Delay 1000
//select echelon 3
dm.MoveTo 500, 375
dm.LeftClick
Delay 1000
//select point
dm.MoveTo 305, 375
dm.LeftClick
Delay 1000

dm.MoveTo 305, 180
dm.LeftClick
Delay 1000

dm.MoveTo 780, 180
dm.LeftClick
Delay 1000
//slide up map
dm.MoveTo 529, 295
Delay 200
For 4
dm.WheelUp
Delay 500
Next
//select point
dm.MoveTo 780, 165
dm.LeftClick
Delay 1000
//select point
dm.MoveTo 550, 165
dm.LeftClick
Delay 1000
//execute plan 
dm.MoveTo 910, 500
dm.LeftClick
Delay 9000
//waiting
Do
i=0
dm_ret = dm.FindPic( 0,0,1366,768,"D:\按键精灵\按键精灵2014\screen\胜利.bmp","020202",0.9,0,intX,intY)
If intX > 0 And intY > 0 Then 
i = 1
Delay 9000
End If
Delay 500
Loop While i = 0

Call ReturnToBase

End If

CompleteTimes = CompleteTimes + 1

SimulateBattle = True

End If

End Sub

