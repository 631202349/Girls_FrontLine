[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=32
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c71c8250-6e8c-4235-8fba-dcd1e3ff1667
Description=主程
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Delay 1000

//************************************************config初始化************************************************

//主程ID
Dimenv ID1

//战斗相关
Dimenv Resupply
Dimenv ChapterSelect
Dimenv Scaling
DimEnv Recycle
Dimenv RepairTimes, Rounds, BattleTimes, RestartTimes

Rounds = 0
RepairTimes = 0
BattleTimes = 0
RestartTimes = 0
Resupply = False
StealBattery = False
Recycle = True
Form1.CheckBox1.Value = 0

//偷电池
Dimenv StealBattery

//时间管理相关
Dimenv ZeroOclock, SixOclock, TwelveOclock, EighteenOclock, MyHour, MyWeekDay, StartTime
ZeroOclock = True
SixOclock = True
TwelveOclock = True
EighteenOclock = True
MyHour = Hour(Now)
MyWeekDay = Weekday(Date)
StartTime = Now

//************************************************config初始化************************************************

//************************************************开始进程************************************************

BeginThread 变量监听
BeginThread 闪退重进
BeginThread 卡bug强退
BeginThread 再派遣
BeginThread 关闭成就弹窗

Rem Restart

Scaling = True
ChapterSelect = True

ID1 = BeginThread(main)

//************************************************开始进程************************************************



//********************************************************************定义主线程********************************************************************
//********************************************************************定义主线程********************************************************************
//********************************************************************定义主线程********************************************************************

Sub main

//TimeMachine
MyHour = Hour(Now)
If MyHour < 6 Then 
ZeroOclock = False
Goto Night
ElseIf MyHour < 12 Then
SixOclock = False
Goto Morning
ElseIf MyHour < 18 Then
TwelveOclock = False
Goto Afternoon
ElseIf MyHour < 24 Then
EighteenOclock = False
Goto Evening
End If

Do
//0点

Call 收每日奖励

Call 打模拟
Rem Night
Call 刷图 

//6点

Call 偷电池
Call 打模拟
Rem Morning

Call 刷图   

//12点
Call 打模拟
Rem Afternoon
Call 刷图

//18点
Call 打模拟
//收任务奖励
Rem Evening
Call 刷图

Loop

End Sub

//********************************************************************任务管理子进程********************************************************************
//********************************************************************任务管理子进程********************************************************************
//********************************************************************任务管理子进程********************************************************************

//******************************刷图控制******************************

Sub 刷图
If Form1.OptionBox1.Value = 1 Then 
Call 刷81n
ElseIf Form1.OptionBox2.Value = 1 Then
Call 刷02
End If
End Sub

//******************************时间管理******************************

Sub 时间管理

MyHour = Hour(Now)

If MyHour = 0 And ZeroOclock = True Then 
Recycle = False
ZeroOclock = False
SixOclock = True
ElseIf MyHour = 6 And SixOclock = True Then 
Recycle = False
SixOclock = False
TwelveOclock = True
ElseIf MyHour = 12 And TwelveOclock = True Then
Recycle = False
TwelveOclock = False
EighteenOclock = True
ElseIf MyHour = 18 And EighteenOclock = True Then 
Recycle = False
EighteenOclock = False
ZeroOclock = True
StealBattery = False
End If

End Sub


//****************************************************辅助线程***********辅助线程***********辅助线程**********************************************************************
//****************************************************辅助线程***********辅助线程***********辅助线程**********************************************************************
//****************************************************辅助线程***********辅助线程***********辅助线程**********************************************************************

//******************************变量监听******************************

Sub 变量监听

Do

Form1.Label1.Caption = Now

Form1.Label2.Caption = "Rounds : " & Rounds

Form1.Label3.Caption = runtime(StartTime)

Form1.Label4.Caption = "BattleTimes : " & BattleTimes

Form1.Label5.Caption = "RestartTimes : " & RestartTimes

Form1.Label6.Caption = "WeekDay : " & MyWeekDay - 1

Form1.Label7.Caption = "RepairTimes" & RepairTimes



Delay 1000

Loop

End Sub

Function runtime(StartTime)

Dim sec, min, hour
sec = 0
min = 0
hour = 0
sec = DateDiff("s", StartTime, Now)
hour = int(sec / 60 / 60)
min = int(sec / 60) - hour * 60
sec = sec - min * 60 - hour * 60 * 60

If hour = 0 and min = 0 Then 
runtime = "已运行 : " & sec & "秒"
ElseIf hour = 0 Then
runtime = "已运行 : " & min & "分" & sec & "秒"
ElseIf hour > 0 Then
runtime = "已运行 : " & hour & "小时"& min & "分" & sec & "秒"
End If

End Function


//******************************卡bug强退******************************
//******************************卡bug强退******************************
//******************************卡bug强退******************************

Sub 卡bug强退

Do

Dim a, b

a = BattleTimes

Delay 1200000

b = BattleTimes

If a = b Then 

MoveTo 600, 65
LeftClick 1

End If

Loop

End Sub

//******************************闪退重进******************************
//******************************闪退重进******************************
//******************************闪退重进******************************

Sub 闪退重进
Do
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\少前.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 

StopThread (ID1)

Rounds = 0

RestartTimes = RestartTimes + 1

Form1.ListBox1.AddItem Now

MoveTo 350, 210
LeftClick 1
Delay 3000
/*
//关闭MUMU弹窗
MoveTo 1135, 100
LeftClick 1
Delay 3000
MoveTo 1135, 100
LeftClick 1
*/
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进入游戏.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

Delay 1500
MoveTo 365, 420
LeftClick 1
Delay 9000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

BeginThread 闪退重进

Call 重进收尾()

End If
Delay 1000
Loop
End Sub

//******************重进收尾****************

Sub 重进收尾

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500
//选择作战任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 1500
Else
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
End If
Loop While i = 0

//如果是81n闪退 
If Form1.OptionBox1.Value = 1 Then 
//选第八章
MoveTo 375, 180
For 3
MouseWheel - 1 
Delay 1500
Next
Delay 1500
MoveTo 375,300
LeftClick 1
Delay 1500
//选择夜战
MoveTo 1110, 222
LeftClick 1
Delay 2000
//选择81n
MoveTo 1080, 300
LeftClick 1
Delay 2000
//终止作战
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\终止作战.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 560, 510
LeftClick 1
Delay 1000
/*
//再派遣代为确定
MoveTo 777, 464
LeftClick 1
Delay 1000
*/
Else 
MoveTo 340, 140
LeftClick 1
Delay 1500
End If

//如果是02闪退 
ElseIf Form1.OptionBox2.Value = 1 Then
//选第零章
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\难度选择.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 365, 170
LeftClick 1
Delay 1500
End If
Loop While i = 0
//选择0-2
MoveTo 750, 365
LeftClick 1
Delay 1500
//终止作战
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\终止作战.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 560, 510
LeftClick 1
Delay 1000
/*
//再派遣代为确定
MoveTo 777, 464
LeftClick 1
Delay 1000
*/
Else 
MoveTo 370, 150
LeftClick 1
Delay 1500
End If
End If

//返回基地
Delay 3000
MoveTo 235, 100
LeftClick 1

If Form1.OptionBox2.Value = 1 Then
Call 快速修复
End If

Call 拆解

Resupply = True

Goto Restart
	
End Sub


//******************************再派遣******************************
//******************************再派遣******************************
//******************************再派遣******************************


Sub 再派遣
Do
//后勤回归
FindPic 0, 0, 1366, 768, "E:\按键精灵\按键精灵2014\screen\后勤回归.bmp", 0.9, intX, intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
End If
//再派遣确定
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\再派遣确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
End If
/*
//确认自律回归
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\胜利.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\再派遣确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
LeftClick 1
Delay 1000
End If
Loop While i = 0
End If
*/
Loop
End Sub

//****************************************************共用子程序***********共用子程序***********共用子程序*******************************************************************
//****************************************************共用子程序***********共用子程序***********共用子程序*******************************************************************
//****************************************************共用子程序***********共用子程序***********共用子程序*******************************************************************

//******************************拆解******************************
//******************************拆解******************************
//******************************拆解******************************
Sub 拆解
Delay 1500
//工厂
MoveTo 1025, 310
LeftClick 1
Delay 4500
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\工厂.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 1025, 310
LeftClick 1
Delay 4500
End If
End If
Loop While i=0

//回收拆解
MoveTo 250, 410
Delay 1500
LeftClick 1
Delay 1500

If Form1.OptionBox1.Value = 1 Then 
//*****************************选择装备*************************
MoveTo 600, 230
Delay 1500
LeftClick 1
Delay 1500
//智能选择
MoveTo 1100, 565
Delay 1500
LeftClick 1
Delay 3000
//确认是否有的拆
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\有得拆.bmp",0.9,intX,intY
If intX> 0 And intY> 0 Then
//有拆就拆
MoveTo 1100, 565
LeftClick 1
Delay 1500
//拆解
LeftClick 1
Delay 3000
Else 
//没得拆就走
MoveTo 230, 110
LeftClick 1
Delay 2000
End If

//拆解3，4星装备
//选择装备
MoveTo 600, 230
LeftClick 1
Delay 1500
//倒序
MoveTo 1080, 450
LeftClick 1
Delay 1500
//选择  
MoveTo 275, 245
LeftClick 1
Delay 1000
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
MoveTo 275, 475
LeftClick 1
Delay 200
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
//确认拆解
MoveTo 1100, 565
LeftClick 1
Delay 1500
LeftClick 1
Delay 1500
//确定
MoveTo 770, 455
LeftClick 1
Delay 3000

ElseIf Form1.OptionBox2.Value = 1 Then
//*******************************选择角色****************************
MoveTo 425, 225
LeftClick 1
Delay 1500
//智能选择
MoveTo 1100, 555
LeftClick 1
Delay 1000
//确定
MoveTo 1100, 555
LeftClick 1
Delay 1000
//拆解
LeftClick 1
Delay 3000
//选择角色
MoveTo 425, 225
LeftClick 1
Delay 1500
//选择  
MoveTo 275, 245
LeftClick 1
Delay 1000
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
MoveTo 275, 475
LeftClick 1
Delay 200
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
//确认拆解
MoveTo 1100, 565
LeftClick 1
Delay 1500
LeftClick 1
Delay 1500
//确定
MoveTo 770, 455
LeftClick 1
Delay 3000

End If

//返回基地
MoveTo 230, 110
LeftClick 1
Delay 3000
End Sub


//******************************快速修复******************************
//******************************快速修复******************************
//******************************快速修复******************************

Sub 快速修复

//修复
Delay 1000
MoveTo 855, 225
LeftClick 1
Delay 2000
//选择角色
Do
f=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\选择修角色.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
f = 1
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
Delay 1000
MoveTo 855, 225
LeftClick 1
Delay 2000
End If
End If
Loop While f = 0
//修复
Delay 1000
MoveTo 725, 325
LeftClick 1
Delay 2000
//确认是否有的修
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\没得休.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
MoveTo 222, 111
LeftClick 1
Delay 3000
Goto backhome
End If
//选择角色
MoveTo 250, 250
LeftClick 1
Delay 100
MoveTo 385, 250
LeftClick 1
Delay 100
MoveTo 520, 250
LeftClick 1
Delay 100
MoveTo 655, 250
LeftClick 1
Delay 100
//确认角色
MoveTo 1110, 510
Delay 100
LeftClick 1
Delay 1000
//使用快修
MoveTo 425, 475
Delay 100
LeftClick 1
Delay 500
//确定修复
MoveTo 930, 470
Delay 500
LeftClick 1
Delay 1000
//修复完成
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\修复完成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 680, 480
Delay 500
LeftClick 1
Delay 500
End If
Loop While i = 0
//返回基地
MoveTo 220, 100
Delay 500
LeftClick 1
Delay 1500
Rem backhome
End Sub

//******************************返回基地******************************
//******************************返回基地******************************
//******************************返回基地******************************
Sub 返回基地
Delay 1500
MoveTo 235, 100
LeftClick 1
Delay 6000
MoveTo 235, 100
LeftClick 1	
Delay 6000
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 235, 100
LeftClick 1	
Delay 6000
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\狗牌.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 699, 365
LeftClick 1	
Delay 6000
End If
End If
Loop While i = 0
End Sub

//******************************关闭******************************（关闭成就弹窗）

Sub 关闭成就弹窗
Do
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\关闭成就.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 685, 475
LeftClick 1
End If
Delay 1000
Loop
End Sub

//*************************************************主任务子程序***********主任务子程序***********主任务子程序*******************************************************************
//*************************************************主任务子程序***********主任务子程序***********主任务子程序*******************************************************************
//*************************************************主任务子程序***********主任务子程序***********主任务子程序*******************************************************************

//************************************************定义刷81n ************************************************
//************************************************定义刷81n ************************************************
//************************************************定义刷81n ************************************************

Sub 刷81n
	
Do

Call 进81n

For 8

Rounds = Rounds + 1

Call 部署81n

Call 战斗81n

BattleTimes = BattleTimes + 1

If Rounds = 8 Then 
Rounds = 0
End If

Next

MyHour = Hour(Now)
If Myhour = 0 and ZeroOclock = True Then 
ZeroOclock = False
Delay 1500
MoveTo 235, 100
LeftClick 1
Delay 6000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
MoveTo 235, 100
LeftClick 1	
Delay 6000
Goto NewDay
End If

Call 返回基地

Call 拆解

Call 时间管理

Loop While Recycle = True

Recycle = True

Rem NewDay

End Sub

//*********************************进81n*******************************
//*********************************进81n*******************************
//*********************************进81n*******************************

Sub 进81n

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500

//选择作战任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 220, 180
LeftClick 1
Delay 3000
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
End If
Loop While i = 0

//仅第一次选章节
If ChapterSelect = True Then 
ChapterSelect = False
//选第八章
MoveTo 375, 180
For 3
MouseWheel - 1 
Delay 1500
Next
Delay 1500
MoveTo 375,300
LeftClick 1
Delay 1500
End If

//选择夜战
MoveTo 1110, 222
LeftClick 1
Delay 2000

//选择81n
MoveTo 1080, 300
LeftClick 1
Delay 2000

//确认是81n
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\81n.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 340, 140
LeftClick 1
Delay 1500
MoveTo 1080, 300
LeftClick 1
Delay 2000
End If
Loop While i = 0

//进入战斗
MoveTo 711, 505
LeftClick 1
Delay 3000

//skip剧情
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\skip.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1110, 110
LeftClick 1
Delay 4500
End If
Loop While i = 0

//确认缩放
If Scaling = True Then 
Scaling = False
MoveTo 699, 365
KeyDown "Ctrl", 1
For 6
MouseWheel - 1 
Delay 1000
Next
KeyUp "Ctrl", 1
End If

End Sub

//*********************************部署81n*******************************
//*********************************部署81n*******************************
//*********************************部署81n*******************************

Sub 部署81n
	
//******************进入编成界面**********************
//选择机场
MoveTo 350, 500
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 350, 500
LeftClick 1
Delay 3000
End If
Loop While i=0

//选择队伍编成
MoveTo 333, 555
LeftClick 1
Delay 3000

//************************编成界面************************

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0


//确认打手队伍
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\选择角色.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
u = 1
v = 1
w = 1
Else 
u = 0
v = 0
w = 0
End If

If u = 0 Then 
//选梯队2
MoveTo 260, 250
LeftClick 1
Delay 1000
End If

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0


//选炮击妖精，net
MoveTo 1100, 300
LeftClick 1
Delay 1000
MoveTo 550, 245
LeftClick 1
Delay 2000


//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//选阵型预设
MoveTo 1060, 575
LeftClick 1
Delay 1000

//选预设
MoveTo 1150, 265
LeftClick 1
Delay 1000

If v = 0 Then 
//选预设队伍2
MoveTo 780, 215
LeftClick 1
Delay 1000
Else 
//选预设队伍1
MoveTo 780, 120
LeftClick 1
Delay 1000
End If

//选套用预设
MoveTo 1060, 555
LeftClick 1
Delay 1000

//确认强制替换
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\强制替换.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
Else 
MoveTo 630, 400
LeftClick 1
Delay 1000
End If

//选确认替换，net
MoveTo 805, 455
LeftClick 1
Delay 1000

//选确认，net
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1080, 560
LeftClick 1
Delay 1000
End If
Loop While i=0

//选返回
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 255, 120
LeftClick 1
Delay 1000
End If
Loop While i = 0

//skip剧情
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\skip.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1110, 110
LeftClick 1
Delay 4500
End If
Loop While i = 0


//************************战斗界面************************

//************************补给部署************************

If w = 1 Then 
//1队打手
//选机场部署打手队
MoveTo 350, 500
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 340, 500
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000
//选择上方机场部署补给队
MoveTo 395, 155
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 390, 130
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000

Else 
//2队打手
//选择上方机场部署补给队
MoveTo 395, 155
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 390, 130
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000
//选机场部署打手队
MoveTo 350, 500
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 350, 500
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000
End If

//开始作战,net
MoveTo 980, 566
LeftClick 1
Delay 3000

//确认任务目标
MoveTo 340, 180
LeftClick 1
Delay 2000

Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\任务简报.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 340, 180
LeftClick 1
Delay 2000
Else 
i = 1
End If
Loop While i=0

End Sub

//*********************************部署81n*******************************
//*********************************部署81n*******************************
//*********************************部署81n*******************************

Sub 战斗81n

//*****************************闪退重进额外补给*********************************
If Resupply = True Then 
Resupply = False
MoveTo 699,365
For 2
MouseWheel 1
Delay 500
Next
Delay 1500
//上方机场补给队补给
MoveTo 366, 166
LeftClick 1
Delay 500
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i=0
//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 9000
//撤离
MoveTo 366, 166
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i = 0
MoveTo 980, 580
LeftClick 1
Delay 2000
MoveTo 765, 465
LeftClick 1
Delay 2000
//终止作战
MoveTo 460, 100
LeftClick 1
Delay 1500
MoveTo 800, 450
LeftClick 1
Delay 3000
Goto restart
End If

//************************计划模式************************
//************************执行计划************************

//选择计划
MoveTo 250, 530
LeftClick 1
Delay 500

//选择打手队
MoveTo 350, 500
LeftClick 1
Delay 500

//选择点1
MoveTo 425, 425
LeftClick 1
Delay 500

//选择点2
MoveTo 445, 300
LeftClick 1
Delay 500

//选择点3
MoveTo 315, 394
LeftClick 1
Delay 500

//选择点4
MoveTo 300, 245
LeftClick 1
Delay 500

//选择点5
MoveTo 445, 215
LeftClick 1
Delay 500

//执行计划
MoveTo 1099, 577
LeftClick 1
Delay 30000

//确认作战完毕
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束81n.bmp",1,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 1000
End If
Loop While i = 0

//上方机场补给队补给
MoveTo 366, 166
LeftClick 1
Delay 500
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i=0
//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 2000
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束81n.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 1000
End If
Loop While i = 0
//撤离
MoveTo 366, 166
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i = 0
MoveTo 980, 580
LeftClick 1
Delay 2000
MoveTo 765, 465
LeftClick 1
Delay 2000

//重新作战
MoveTo 460, 100
LeftClick 1
Delay 1500
MoveTo 566, 456
LeftClick 1
Delay 3000

//skip剧情
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\skip.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1110, 110
LeftClick 1
Delay 4500
End If
Loop While i = 0

End Sub




//************************************************定义刷02 ************************************************
//************************************************定义刷02 ************************************************
//************************************************定义刷02 ************************************************

Sub 刷02
	
Do

Call 进02

For 6

Rounds = Rounds + 1

Call 部署02

Call 战斗02

If Rounds = 6 Then 
Rounds = 0
End If

BattleTimes = BattleTimes + 1

Next

MyHour = Hour(Now)
If Myhour = 0 and ZeroOclock = True Then 
ZeroOclock = False
Delay 1500
MoveTo 235, 100
LeftClick 1
Delay 6000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
MoveTo 235, 100
LeftClick 1	
Delay 6000
Goto NewDay
End If

Call 返回基地

Call 快速修复

RepairTimes = RepairTimes + 1

If Form1.OptionBox1.Value = 1 Then 
RepairTime = 0
End If

Call 拆解

Call 时间管理

Loop While Recycle = True

Recycle = True

Rem NewDay

End Sub

//*********************************进02*******************************
//*********************************进02*******************************
//*********************************进02*******************************

Sub 进02

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500

//选择作战任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 280, 200
LeftClick 1
Delay 1500
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
End If
Loop While i = 0

//仅第一次选章节
If ChapterSelect = True Then 
ChapterSelect = False
//选第零章
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\难度选择.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 365, 170
LeftClick 1
Delay 1500
End If
Loop While i = 0
End If

//选择0-2
MoveTo 750, 365
LeftClick 1
Delay 1500

//确认是0-2
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\02.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 360, 145
LeftClick 1
Delay 1000
MoveTo 750, 365
LeftClick 1
Delay 1500
End If
Loop While i = 0

//进入战斗
MoveTo 711, 505
LeftClick 1
Delay 5000

//确认进图完毕
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
Else 
i=0
End If
Loop While i=0

End Sub

//*********************************部署02*******************************
//*********************************部署02*******************************
//*********************************部署02*******************************

Sub 部署02

//******************进入编成界面**********************
//选择指挥部
MoveTo 680, 350
LeftClick 1
Delay 1000

//选择队伍编成
MoveTo 333, 555
LeftClick 1
Delay 3000

//************************编成界面************************

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0


//确认打手队伍
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\选择角色.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
u = 1
v = 1
w = 1
Else 
u = 0
v = 0
w = 0
End If

If u = 0 Then 
//选梯队2
MoveTo 260, 250
LeftClick 1
Delay 1000
End If

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//选妖精
MoveTo 1100, 300
LeftClick 1
Delay 1000
/*
//选搜救妖精，net
MoveTo 680, 250
*/
//选炮击妖精，net
MoveTo 550, 245

LeftClick 1
Delay 2000

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//选阵型预设
MoveTo 1060, 575
LeftClick 1
Delay 1000

//选预设
MoveTo 1150, 265
LeftClick 1
Delay 1000

If v = 0 Then 
//选预设队伍2
MoveTo 780, 215
LeftClick 1
Delay 1000
Else 
//选预设队伍1
MoveTo 780, 120
LeftClick 1
Delay 1000
End If

//选套用预设
MoveTo 1060, 555
LeftClick 1
Delay 1000

//确认强制替换
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\强制替换.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
Else 
MoveTo 630, 400
LeftClick 1
Delay 1000
End If

//选确认替换，net
MoveTo 805, 455
LeftClick 1
Delay 1000

//选确认，net
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1080, 560
LeftClick 1
Delay 1000
End If
Loop While i=0

//选返回
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 255, 120
LeftClick 1
Delay 1000
End If
Loop While i = 0

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 1000

//************************战斗界面************************
If w = 0 Then 
//选机场部署补给队
MoveTo 270, 340
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0
//选择指挥部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500

Else 
//选择指挥部部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0
//选机场部署补给队
MoveTo 270, 340
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500
End If

//开始作战,net
MoveTo 980, 566
LeftClick 1
Delay 2000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 500

End Sub

//*********************************战斗02*******************************
//*********************************战斗02*******************************
//*********************************战斗02*******************************

Sub 战斗02

//************************补给************************

//选中补给队
MoveTo 270, 340
LeftClick 1
Delay 1000
LeftClick 1
Delay 1000

//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 2000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 2000

//***********************闪退重进后需重新补给指挥部打手队***************************
If Resupply = True Then 
Resupply = False
//选择指挥部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1000
LeftClick 1
Delay 1000

//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 2000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 2000

End If

//************************妖精指令************************

FindPic 0, 0, 1366, 768, "E:\按键精灵\按键精灵2014\screen\空指令.bmp", 1, intX, intY
If intX > 0 And intY > 0 Then 
t = 0
Else 
t = 1
End If

If t = 1 and Form1.CheckBox1.Value = 1 Then 
	
//选择指挥部部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1000

//妖精指令，net
MoveTo 1140, 390
LeftClick 1
Delay 1000
MoveTo 680, 350
LeftClick 1
Delay 2500

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

End If

//************************计划模式************************
//************************执行计划************************

//选择计划
MoveTo 250, 530
LeftClick 1
Delay 1000

//选择打手队
MoveTo 680, 350
LeftClick 1
Delay 1000

//选择点1
MoveTo 520, 250
LeftClick 1
Delay 1000

//上划地图
MoveTo 970, 420
Delay 200
For 10
MouseWheel 1
Delay 500
Next

//选择点2
MoveTo 545, 605
LeftClick 1
Delay 1000

//选择点3
MoveTo 700, 450
LeftClick 1
Delay 1000

//选择点4
MoveTo 550, 350
LeftClick 1
Delay 1000

//执行计划
MoveTo 1099, 577
LeftClick 1
Delay 1000

//等待推图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束021.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

Delay 10000

//结束回合
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束021.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 1070, 580
LeftClick 1
End If
Loop While i = 0

Delay 10000

//等待读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 10000

//等待读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

//************************妖精指令************************

FindPic 0, 0, 1366, 768, "E:\按键精灵\按键精灵2014\screen\空指令.bmp", 1, intX, intY
If intX > 0 And intY > 0 Then 
t = 0
Else 
t = 1
End If

If t = 1 and Form1.CheckBox1.Value = 1 Then 

//选择打手队
MoveTo 690, 350
LeftClick 1
Delay 1000

//妖精指令，net
MoveTo 1140, 390
LeftClick 1
Delay 1000
MoveTo 690, 350
LeftClick 1
Delay 2500
End If

//选择计划
MoveTo 250, 530
LeftClick 1
Delay 1000

//选择打手队
MoveTo 690, 350
LeftClick 1
Delay 1000


//确认选中
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\0-2-3.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
//选择计划
MoveTo 250, 530
LeftClick 1
Delay 1000
//选择打手队
MoveTo 690, 350
LeftClick 1
Delay 1000
Delay 1000
End If
Loop While i=0


//选择点5
MoveTo 980, 350
LeftClick 1
Delay 1000

//选择点6
MoveTo 1140, 385
LeftClick 1
Delay 1000

//执行计划
MoveTo 1099, 577
LeftClick 1
Delay 1000

Delay 40000

//结束回合
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束022.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
LeftClick 1
Delay 1000
End If
Loop While i = 0

//成果结算
Delay 5000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\结算S.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 2000
End If
Loop While i = 0

Delay 2000
MoveTo 699, 365
LeftClick 1
Delay 1500
LeftClick 1
Delay 500
LeftClick 1
Delay 500
LeftClick 1
Delay 500


//************************继续刷图************************

Delay 9000

//选择0-2
MoveTo 750, 365
LeftClick 1
Delay 1000

//确认是0-2
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\02.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 360, 145
LeftClick 1
Delay 1000
MoveTo 750, 365
LeftClick 1
Delay 1500
End If
Loop While i = 0

//进入战斗
MoveTo 711, 505
LeftClick 1
Delay 5000

//确认进图完毕
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
Else 
i=0
End If
Loop While i=0

End Sub





//*************************************************其他任务子程序***********其他任务子程序***********其他任务子程序*******************************************************************
//*************************************************其他任务子程序***********其他任务子程序***********其他任务子程序*******************************************************************
//*************************************************其他任务子程序***********其他任务子程序***********其他任务子程序*******************************************************************

//************************************************收每日奖励 ************************************************

Sub 收每日奖励

Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\每日奖励.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//重磅热点，系统公告返回
MoveTo 300, 125
LeftClick 1
Delay 1500
MoveTo 280, 135
LeftClick 1
Delay 3000
//关闭奖励
MoveTo 695, 475
LeftClick 1
Delay 3000
//关闭活动窗口
MoveTo 255, 140
LeftClick 1
Delay 3000

End Sub

//******************************偷电池******************************

Sub 偷电池

If StealBattery = False Then 

//选择好友
MoveTo 1060, 600
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\好友.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 2000
End If
Loop While i = 0
//选择排序
MoveTo 950, 200
LeftClick 1
Delay 1000
MoveTo 1100, 380
LeftClick 1
Delay 1000
//进宿舍
MoveTo 430, 280
LeftClick 1
Delay 1000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\名片.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
MoveTo 930, 550
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回宿舍.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//偷电
For 12
MoveTo 440, 410
LeftClick 1
Delay 1000
MoveTo 700, 480
LeftClick 1
Delay 1000
MoveTo 1090, 600
LeftClick 1
Delay 1000
MoveTo 365, 585
LeftClick 1
Delay 6000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回宿舍.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
Next
//返回宿舍
MoveTo 265, 120
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\离开宿舍.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//离开宿舍
MoveTo 265, 120
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

StealBattery = True

End If

End Sub

//******************************打模拟******************************
//******************************打模拟******************************
//******************************打模拟******************************

Sub 打模拟

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500

//选择模拟任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 280, 335
LeftClick 1
Delay 1000
Else 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
Loop While i = 0

//周二五日（361）打资料
MyWeekDay = Weekday(Date)
If MyWeekDay = 3 or MyWeekDay = 6 or MyWeekDay = 1 Then 
//选资料（默认中级）
MoveTo 400, 270
LeftClick 1
Delay 1000

//中级
MoveTo 775, 390
LeftClick 1
Delay 1000
/*
//初级
MoveTo 775, 305
LeftClick 1
Delay 1000

//高级
MoveTo 775, 480
LeftClick 1
Delay 1000
*/
//进入战斗
MoveTo 890, 520
LeftClick 1
Delay 1000
//确认
MoveTo 770, 450
LeftClick 1
Delay 15000
//等待胜利
LeftClick 1
Delay 9000
//返回基地
MoveTo 260, 125
LeftClick 1
Delay 9000

//其他时候打碎片
Else 
///选碎片
MoveTo 400, 430
LeftClick 1
Delay 1000
//高级
MoveTo 775, 485
LeftClick 1
Delay 1000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\高模碎片.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//选择机场
MoveTo 685, 360
LeftClick 1
Delay 1000
//选择默认梯队3
MoveTo 250, 430
LeftClick 1
Delay 1000
//确认
MoveTo 1080, 570
LeftClick 1
Delay 1000
//开始作战
MoveTo 1080, 570
LeftClick 1
Delay 1000
//确认
MoveTo 770, 450
LeftClick 1
Delay 6000
//读图
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\高模碎片.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
//缩放
MoveTo 699, 365
KeyDown "Ctrl", 1
For 6
MouseWheel - 1 
Delay 1000
Next
KeyUp "Ctrl", 1
End If
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\高模碎片s.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//计划模式
MoveTo 250, 530
LeftClick 1
Delay 1000
//选择打手
MoveTo 670, 445
LeftClick 1
Delay 1000
//选择点1
MoveTo 475, 445
LeftClick 1
Delay 1000
//选择点2
MoveTo 475, 250
LeftClick 1
Delay 1000
//选择点3
MoveTo 950, 250
LeftClick 1
Delay 1000
//上划
MoveTo 699, 365
Delay 200
For 4
MouseWheel 1
Delay 500
Next
//选择点4
MoveTo 950, 235
LeftClick 1
Delay 1000
//选择点5
MoveTo 720, 235
LeftClick 1
Delay 1000
//执行任务 
MoveTo 1080, 570
LeftClick 1
Delay 9000
//等待战役胜利
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\胜利.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 9000
End If
Loop While i = 0
//返回基地
MoveTo 270, 140
LeftClick 1
Delay 9000

End If

End Sub

