[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=32
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=a505ffc4-514b-47d0-9e7f-3aa17aa63e5c
Description=主程
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Delay 1000

//************************************************config初始化************************************************

//主程ID
Dimenv ID1

//战斗相关
Dimenv Resupply
Dimenv ChapterSelect
Dimenv Scaling
DimEnv Recycle
Dimenv RepairTimes, Rounds, BattleTimes, RestartTimes

Rounds = 0
RepairTimes = 0
BattleTimes = 0
RestartTimes = 0
Resupply = False
StealBattery = False
Recycle = True
Form1.CheckBox1.Value = 0

//偷电池
Dimenv StealBattery

//时间管理相关
Dimenv ZeroOclock, SixOclock, TwelveOclock, EighteenOclock, MyHour, MyWeekDay, StartTime
ZeroOclock = True
SixOclock = True
TwelveOclock = True
EighteenOclock = True
MyHour = Hour(Now)
MyWeekDay = Weekday(Date)
StartTime = Now

//************************************************config初始化************************************************

//************************************************开始进程************************************************

BeginThread 变量监听
BeginThread 闪退重进
BeginThread 卡bug强退
BeginThread 再派遣
BeginThread 关闭成就弹窗

Rem Restart

Scaling = True
ChapterSelect = True

ID1 = BeginThread(main)

//************************************************开始进程************************************************



//********************************************************************定义主线程********************************************************************
//********************************************************************定义主线程********************************************************************
//********************************************************************定义主线程********************************************************************

Sub main

//TimeMachine
MyHour = Hour(Now)
If MyHour < 6 Then 
ZeroOclock = False
Goto Night
ElseIf MyHour < 12 Then
SixOclock = False
Goto Morning
ElseIf MyHour < 18 Then
TwelveOclock = False
Goto Afternoon
ElseIf MyHour < 24 Then
EighteenOclock = False
Goto Evening
End If

Do
//0点

Call 收每日奖励

Call 打模拟
Rem Night
Call 刷图 

//6点

Call 偷电池
Call 打模拟
Rem Morning

Call 刷图   

//12点
Call 打模拟
Rem Afternoon
Call 刷图

//18点
Call 打模拟
//收任务奖励
Rem Evening
Call 刷图

Loop

End Sub

//********************************************************************任务管理子进程********************************************************************
//********************************************************************任务管理子进程********************************************************************
//********************************************************************任务管理子进程********************************************************************

//******************************刷图控制******************************

Sub 刷图
If Form1.OptionBox1.Value = 1 Then 
Call 刷81n
ElseIf Form1.OptionBox2.Value = 1 Then
Call 刷02
End If
End Sub

//******************************时间管理******************************

Sub 时间管理

MyHour = Hour(Now)

If MyHour = 0 And ZeroOclock = True Then 
Recycle = False
ZeroOclock = False
SixOclock = True
ElseIf MyHour = 6 And SixOclock = True Then 
Recycle = False
SixOclock = False
TwelveOclock = True
ElseIf MyHour = 12 And TwelveOclock = True Then
Recycle = False
TwelveOclock = False
EighteenOclock = True
ElseIf MyHour = 18 And EighteenOclock = True Then 
Recycle = False
EighteenOclock = False
ZeroOclock = True
StealBattery = False
End If

End Sub


//****************************************************辅助线程***********辅助线程***********辅助线程**********************************************************************
//****************************************************辅助线程***********辅助线程***********辅助线程**********************************************************************
//****************************************************辅助线程***********辅助线程***********辅助线程**********************************************************************

//******************************变量监听******************************

Sub 变量监听

Do

Form1.Label1.Caption = Now

Form1.Label2.Caption = "Rounds : " & Rounds

Form1.Label3.Caption = runtime(StartTime)

Form1.Label4.Caption = "BattleTimes : " & BattleTimes

Form1.Label5.Caption = "RestartTimes : " & RestartTimes

Form1.Label6.Caption = "WeekDay : " & MyWeekDay - 1

Form1.Label7.Caption = "RepairTimes" & RepairTimes



Delay 1000

Loop

End Sub

Function runtime(StartTime)

Dim sec, min, hour
sec = 0
min = 0
hour = 0
sec = DateDiff("s", StartTime, Now)
hour = int(sec / 60 / 60)
min = int(sec / 60) - hour * 60
sec = sec - min * 60 - hour * 60 * 60

If hour = 0 and min = 0 Then 
runtime = "已运行 : " & sec & "秒"
ElseIf hour = 0 Then
runtime = "已运行 : " & min & "分" & sec & "秒"
ElseIf hour > 0 Then
runtime = "已运行 : " & hour & "小时"& min & "分" & sec & "秒"
End If

End Function


//******************************卡bug强退******************************
//******************************卡bug强退******************************
//******************************卡bug强退******************************

Sub 卡bug强退

Do

Dim a, b

a = BattleTimes

Delay 1200000

b = BattleTimes

If a = b Then 

MoveTo 600, 65
LeftClick 1

End If

Loop

End Sub

//******************************闪退重进******************************
//******************************闪退重进******************************
//******************************闪退重进******************************

Sub 闪退重进
Do
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\少前.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 

StopThread (ID1)

Rounds = 0

RestartTimes = RestartTimes + 1

Form1.ListBox1.AddItem Now

MoveTo 350, 210
LeftClick 1
Delay 3000
/*
//关闭MUMU弹窗
MoveTo 1135, 100
LeftClick 1
Delay 3000
MoveTo 1135, 100
LeftClick 1
*/
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进入游戏.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

Delay 1500
MoveTo 365, 420
LeftClick 1
Delay 9000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

BeginThread 闪退重进

Call 重进收尾()

End If
Delay 1000
Loop
End Sub

//******************重进收尾****************

Sub 重进收尾

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500
//选择作战任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 1500
Else
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
End If
Loop While i = 0

//如果是81n闪退 
If Form1.OptionBox1.Value = 1 Then 
//选第八章
MoveTo 375, 180
For 3
MouseWheel - 1 
Delay 1500
Next
Delay 1500
MoveTo 375,300
LeftClick 1
Delay 1500
//选择夜战
MoveTo 1110, 222
LeftClick 1
Delay 2000
//选择81n
MoveTo 1080, 300
LeftClick 1
Delay 2000
//终止作战
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\终止作战.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 560, 510
LeftClick 1
Delay 1000
/*
//再派遣代为确定
MoveTo 777, 464
LeftClick 1
Delay 1000
*/
Else 
MoveTo 340, 140
LeftClick 1
Delay 1500
End If

//如果是02闪退 
ElseIf Form1.OptionBox2.Value = 1 Then
//选第零章
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\难度选择.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 365, 170
LeftClick 1
Delay 1500
End If
Loop While i = 0
//选择0-2
MoveTo 750, 365
LeftClick 1
Delay 1500
//终止作战
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\终止作战.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 560, 510
LeftClick 1
Delay 1000
/*
//再派遣代为确定
MoveTo 777, 464
LeftClick 1
Delay 1000
*/
Else 
MoveTo 370, 150
LeftClick 1
Delay 1500
End If
End If

//返回基地
Delay 3000
MoveTo 235, 100
LeftClick 1

If Form1.OptionBox2.Value = 1 Then
Call 快速修复
End If

Call 拆解

Resupply = True

Goto Restart
	
End Sub


//******************************再派遣******************************
//******************************再派遣******************************
//******************************再派遣******************************


Sub 再派遣
Do
//后勤回归
FindPic 0, 0, 1366, 768, "E:\按键精灵\按键精灵2014\screen\后勤回归.bmp", 0.9, intX, intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
End If
//再派遣确定
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\再派遣确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
End If
/*
//确认自律回归
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\胜利.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\再派遣确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
LeftClick 1
Delay 1000
End If
Loop While i = 0
End If
*/
Loop
End Sub

//****************************************************共用子程序***********共用子程序***********共用子程序*******************************************************************
//****************************************************共用子程序***********共用子程序***********共用子程序*******************************************************************
//****************************************************共用子程序***********共用子程序***********共用子程序*******************************************************************

//******************************拆解******************************
//******************************拆解******************************
//******************************拆解******************************
Sub 拆解
Delay 1500
//工厂
MoveTo 1025, 310
LeftClick 1
Delay 4500
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\工厂.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 1025, 310
LeftClick 1
Delay 4500
End If
End If
Loop While i=0

//回收拆解
MoveTo 250, 410
Delay 1500
LeftClick 1
Delay 1500

If Form1.OptionBox1.Value = 1 Then 
//*****************************选择装备*************************
MoveTo 600, 230
Delay 1500
LeftClick 1
Delay 1500
//智能选择
MoveTo 1100, 565
Delay 1500
LeftClick 1
Delay 3000
//确认是否有的拆
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\有得拆.bmp",0.9,intX,intY
If intX> 0 And intY> 0 Then
//有拆就拆
MoveTo 1100, 565
LeftClick 1
Delay 1500
//拆解
LeftClick 1
Delay 3000
Else 
//没得拆就走
MoveTo 230, 110
LeftClick 1
Delay 2000
End If

//拆解3，4星装备
//选择装备
MoveTo 600, 230
LeftClick 1
Delay 1500
//倒序
MoveTo 1080, 450
LeftClick 1
Delay 1500
//选择  
MoveTo 275, 245
LeftClick 1
Delay 1000
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
MoveTo 275, 475
LeftClick 1
Delay 200
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
//确认拆解
MoveTo 1100, 565
LeftClick 1
Delay 1500
LeftClick 1
Delay 1500
//确定
MoveTo 770, 455
LeftClick 1
Delay 3000

ElseIf Form1.OptionBox2.Value = 1 Then
//*******************************选择角色****************************
MoveTo 425, 225
LeftClick 1
Delay 1500
//智能选择
MoveTo 1100, 555
LeftClick 1
Delay 1000
//确定
MoveTo 1100, 555
LeftClick 1
Delay 1000
//拆解
LeftClick 1
Delay 3000
//选择角色
MoveTo 425, 225
LeftClick 1
Delay 1500
//选择  
MoveTo 275, 245
LeftClick 1
Delay 1000
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
MoveTo 275, 475
LeftClick 1
Delay 200
For 5
MoveR 140, 0
LeftClick 1
Delay 200
Next
//确认拆解
MoveTo 1100, 565
LeftClick 1
Delay 1500
LeftClick 1
Delay 1500
//确定
MoveTo 770, 455
LeftClick 1
Delay 3000

End If

//返回基地
MoveTo 230, 110
LeftClick 1
Delay 3000
End Sub


//******************************快速修复******************************
//******************************快速修复******************************
//******************************快速修复******************************

Sub 快速修复

//修复
Delay 1000
MoveTo 855, 225
LeftClick 1
Delay 2000
//选择角色
Do
f=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\选择修角色.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
f = 1
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
Delay 1000
MoveTo 855, 225
LeftClick 1
Delay 2000
End If
End If
Loop While f = 0
//修复
Delay 1000
MoveTo 725, 325
LeftClick 1
Delay 2000
//确认是否有的修
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\没得休.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo intX, intY
LeftClick 1
Delay 1500
MoveTo 222, 111
LeftClick 1
Delay 3000
Goto backhome
End If
//选择角色
MoveTo 250, 250
LeftClick 1
Delay 100
MoveTo 385, 250
LeftClick 1
Delay 100
MoveTo 520, 250
LeftClick 1
Delay 100
MoveTo 655, 250
LeftClick 1
Delay 100
//确认角色
MoveTo 1110, 510
Delay 100
LeftClick 1
Delay 1000
//使用快修
MoveTo 425, 475
Delay 100
LeftClick 1
Delay 500
//确定修复
MoveTo 930, 470
Delay 500
LeftClick 1
Delay 1000
//修复完成
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\修复完成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 680, 480
Delay 500
LeftClick 1
Delay 500
End If
Loop While i = 0
//返回基地
MoveTo 220, 100
Delay 500
LeftClick 1
Delay 1500
Rem backhome
End Sub

//******************************返回基地******************************
//******************************返回基地******************************
//******************************返回基地******************************
Sub 返回基地
Delay 1500
MoveTo 235, 100
LeftClick 1
Delay 6000
MoveTo 235, 100
LeftClick 1	
Delay 6000
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 235, 100
LeftClick 1	
Delay 6000
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\狗牌.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 699, 365
LeftClick 1	
Delay 6000
End If
End If
Loop While i = 0
End Sub

//******************************关闭******************************（关闭成就弹窗）

Sub 关闭成就弹窗
Do
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\关闭成就.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 685, 475
LeftClick 1
End If
Delay 1000
Loop
End Sub

//*************************************************主任务子程序***********主任务子程序***********主任务子程序*******************************************************************
//*************************************************主任务子程序***********主任务子程序***********主任务子程序*******************************************************************
//*************************************************主任务子程序***********主任务子程序***********主任务子程序*******************************************************************

//************************************************定义刷81n ************************************************
//************************************************定义刷81n ************************************************
//************************************************定义刷81n ************************************************

Sub 刷81n
	
Do

Call 进81n

For 8

Rounds = Rounds + 1

Call 部署81n

Call 战斗81n

BattleTimes = BattleTimes + 1

If Rounds = 8 Then 
Rounds = 0
End If

Next

MyHour = Hour(Now)
If Myhour = 0 and ZeroOclock = True Then 
ZeroOclock = False
Delay 1500
MoveTo 235, 100
LeftClick 1
Delay 6000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
MoveTo 235, 100
LeftClick 1	
Delay 6000
Goto NewDay
End If

Call 返回基地

Call 拆解

Call 时间管理

Loop While Recycle = True

Recycle = True

Rem NewDay

End Sub

//*********************************进81n*******************************
//*********************************进81n*******************************
//*********************************进81n*******************************

Sub 进81n

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500

//选择作战任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 220, 180
LeftClick 1
Delay 3000
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
End If
Loop While i = 0

//仅第一次选章节
If ChapterSelect = True Then 
ChapterSelect = False
//选第八章
MoveTo 375, 180
For 3
MouseWheel - 1 
Delay 1500
Next
Delay 1500
MoveTo 375,300
LeftClick 1
Delay 1500
End If

//选择夜战
MoveTo 1110, 222
LeftClick 1
Delay 2000

//选择81n
MoveTo 1080, 300
LeftClick 1
Delay 2000

//确认是81n
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\81n.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 340, 140
LeftClick 1
Delay 1500
MoveTo 1080, 300
LeftClick 1
Delay 2000
End If
Loop While i = 0

//进入战斗
MoveTo 711, 505
LeftClick 1
Delay 3000

//skip剧情
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\skip.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1110, 110
LeftClick 1
Delay 4500
End If
Loop While i = 0

//确认缩放
If Scaling = True Then 
Scaling = False
MoveTo 699, 365
KeyDown "Ctrl", 1
For 6
MouseWheel - 1 
Delay 1000
Next
KeyUp "Ctrl", 1
End If

End Sub

//*********************************部署81n*******************************
//*********************************部署81n*******************************
//*********************************部署81n*******************************

Sub 部署81n
	
//******************进入编成界面**********************
//选择机场
MoveTo 350, 500
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 350, 500
LeftClick 1
Delay 3000
End If
Loop While i=0

//选择队伍编成
MoveTo 333, 555
LeftClick 1
Delay 3000

//************************编成界面************************

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0


//确认打手队伍
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\选择角色.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
u = 1
v = 1
w = 1
Else 
u = 0
v = 0
w = 0
End If

If u = 0 Then 
//选梯队2
MoveTo 260, 250
LeftClick 1
Delay 1000
End If

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0


//选炮击妖精，net
MoveTo 1100, 300
LeftClick 1
Delay 1000
MoveTo 550, 245
LeftClick 1
Delay 2000


//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//选阵型预设
MoveTo 1060, 575
LeftClick 1
Delay 1000

//选预设
MoveTo 1150, 265
LeftClick 1
Delay 1000

If v = 0 Then 
//选预设队伍2
MoveTo 780, 215
LeftClick 1
Delay 1000
Else 
//选预设队伍1
MoveTo 780, 120
LeftClick 1
Delay 1000
End If

//选套用预设
MoveTo 1060, 555
LeftClick 1
Delay 1000

//确认强制替换
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\强制替换.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
Else 
MoveTo 630, 400
LeftClick 1
Delay 1000
End If

//选确认替换，net
MoveTo 805, 455
LeftClick 1
Delay 1000

//选确认，net
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1080, 560
LeftClick 1
Delay 1000
End If
Loop While i=0

//选返回
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 255, 120
LeftClick 1
Delay 1000
End If
Loop While i = 0

//skip剧情
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\skip.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1110, 110
LeftClick 1
Delay 4500
End If
Loop While i = 0


//************************战斗界面************************

//************************补给部署************************

If w = 1 Then 
//1队打手
//选机场部署打手队
MoveTo 350, 500
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 340, 500
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000
//选择上方机场部署补给队
MoveTo 395, 155
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 390, 130
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000

Else 
//2队打手
//选择上方机场部署补给队
MoveTo 395, 155
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 390, 130
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000
//选机场部署打手队
MoveTo 350, 500
LeftClick 1
Delay 3000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 350, 500
LeftClick 1
Delay 3000
End If
Loop While i=0
MoveTo 1100, 570
LeftClick 1
Delay 2000
End If

//开始作战,net
MoveTo 980, 566
LeftClick 1
Delay 3000

//确认任务目标
MoveTo 340, 180
LeftClick 1
Delay 2000

Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\任务简报.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 340, 180
LeftClick 1
Delay 2000
Else 
i = 1
End If
Loop While i=0

End Sub

//*********************************部署81n*******************************
//*********************************部署81n*******************************
//*********************************部署81n*******************************

Sub 战斗81n

//*****************************闪退重进额外补给*********************************
If Resupply = True Then 
Resupply = False
MoveTo 699,365
For 2
MouseWheel 1
Delay 500
Next
Delay 1500
//上方机场补给队补给
MoveTo 366, 166
LeftClick 1
Delay 500
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i=0
//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 9000
//撤离
MoveTo 366, 166
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i = 0
MoveTo 980, 580
LeftClick 1
Delay 2000
MoveTo 765, 465
LeftClick 1
Delay 2000
//终止作战
MoveTo 460, 100
LeftClick 1
Delay 1500
MoveTo 800, 450
LeftClick 1
Delay 3000
Goto restart
End If

//************************计划模式************************
//************************执行计划************************

//选择计划
MoveTo 250, 530
LeftClick 1
Delay 500

//选择打手队
MoveTo 350, 500
LeftClick 1
Delay 500

//选择点1
MoveTo 425, 425
LeftClick 1
Delay 500

//选择点2
MoveTo 445, 300
LeftClick 1
Delay 500

//选择点3
MoveTo 315, 394
LeftClick 1
Delay 500

//选择点4
MoveTo 300, 245
LeftClick 1
Delay 500

//选择点5
MoveTo 445, 215
LeftClick 1
Delay 500

//执行计划
MoveTo 1099, 577
LeftClick 1
Delay 30000

//确认作战完毕
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束81n.bmp",1,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 1000
End If
Loop While i = 0

//上方机场补给队补给
MoveTo 366, 166
LeftClick 1
Delay 500
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i=0
//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 2000
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束81n.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 1000
End If
Loop While i = 0
//撤离
MoveTo 366, 166
LeftClick 1
Delay 1500
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\队伍编成.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else
MoveTo 366, 166
LeftClick 1
Delay 1500
End If
Loop While i = 0
MoveTo 980, 580
LeftClick 1
Delay 2000
MoveTo 765, 465
LeftClick 1
Delay 2000

//重新作战
MoveTo 460, 100
LeftClick 1
Delay 1500
MoveTo 566, 456
LeftClick 1
Delay 3000

//skip剧情
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\skip.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1110, 110
LeftClick 1
Delay 4500
End If
Loop While i = 0

End Sub




//************************************************定义刷02 ************************************************
//************************************************定义刷02 ************************************************
//************************************************定义刷02 ************************************************

Sub 刷02
	
Do

Call 进02

For 6

Rounds = Rounds + 1

Call 部署02

Call 战斗02

If Rounds = 6 Then 
Rounds = 0
End If

BattleTimes = BattleTimes + 1

Next

MyHour = Hour(Now)
If Myhour = 0 and ZeroOclock = True Then 
ZeroOclock = False
Delay 1500
MoveTo 235, 100
LeftClick 1
Delay 6000
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
MoveTo 235, 100
LeftClick 1	
Delay 6000
Goto NewDay
End If

Call 返回基地

Call 快速修复

RepairTimes = RepairTimes + 1

If Form1.OptionBox1.Value = 1 Then 
RepairTime = 0
End If

Call 拆解

Call 时间管理

Loop While Recycle = True

Recycle = True

Rem NewDay

End Sub

//*********************************进02*******************************
//*********************************进02*******************************
//*********************************进02*******************************

Sub 进02

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500

//选择作战任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 280, 200
LeftClick 1
Delay 1500
Else 
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
End If
Loop While i = 0

//仅第一次选章节
If ChapterSelect = True Then 
ChapterSelect = False
//选第零章
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\难度选择.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 365, 170
LeftClick 1
Delay 1500
End If
Loop While i = 0
End If

//选择0-2
MoveTo 750, 365
LeftClick 1
Delay 1500

//确认是0-2
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\02.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 360, 145
LeftClick 1
Delay 1000
MoveTo 750, 365
LeftClick 1
Delay 1500
End If
Loop While i = 0

//进入战斗
MoveTo 711, 505
LeftClick 1
Delay 5000

//确认进图完毕
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
Else 
i=0
End If
Loop While i=0

End Sub

//*********************************部署02*******************************
//*********************************部署02*******************************
//*********************************部署02*******************************

Sub 部署02

//******************进入编成界面**********************
//选择指挥部
MoveTo 680, 350
LeftClick 1
Delay 1000

//选择队伍编成
MoveTo 333, 555
LeftClick 1
Delay 3000

//************************编成界面************************

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0


//确认打手队伍
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\选择角色.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
u = 1
v = 1
w = 1
Else 
u = 0
v = 0
w = 0
End If

If u = 0 Then 
//选梯队2
MoveTo 260, 250
LeftClick 1
Delay 1000
End If

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//选妖精
MoveTo 1100, 300
LeftClick 1
Delay 1000
/*
//选搜救妖精，net
MoveTo 680, 250
*/
//选炮击妖精，net
MoveTo 550, 245

LeftClick 1
Delay 2000

//确认渲染
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\阵型预设.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//选阵型预设
MoveTo 1060, 575
LeftClick 1
Delay 1000

//选预设
MoveTo 1150, 265
LeftClick 1
Delay 1000

If v = 0 Then 
//选预设队伍2
MoveTo 780, 215
LeftClick 1
Delay 1000
Else 
//选预设队伍1
MoveTo 780, 120
LeftClick 1
Delay 1000
End If

//选套用预设
MoveTo 1060, 555
LeftClick 1
Delay 1000

//确认强制替换
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\强制替换.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
Else 
MoveTo 630, 400
LeftClick 1
Delay 1000
End If

//选确认替换，net
MoveTo 805, 455
LeftClick 1
Delay 1000

//选确认，net
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\确定.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 1080, 560
LeftClick 1
Delay 1000
End If
Loop While i=0

//选返回
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
MoveTo 255, 120
LeftClick 1
Delay 1000
End If
Loop While i = 0

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 1000

//************************战斗界面************************
If w = 0 Then 
//选机场部署补给队
MoveTo 270, 340
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0
//选择指挥部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500

Else 
//选择指挥部部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0
//选机场部署补给队
MoveTo 270, 340
LeftClick 1
Delay 1500
MoveTo 1100, 570
LeftClick 1
Delay 1500
End If

//开始作战,net
MoveTo 980, 566
LeftClick 1
Delay 2000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 500

End Sub

//*********************************战斗02*******************************
//*********************************战斗02*******************************
//*********************************战斗02*******************************

Sub 战斗02

//************************补给************************

//选中补给队
MoveTo 270, 340
LeftClick 1
Delay 1000
LeftClick 1
Delay 1000

//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 2000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 2000

//***********************闪退重进后需重新补给指挥部打手队***************************
If Resupply = True Then 
Resupply = False
//选择指挥部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1000
LeftClick 1
Delay 1000

//补给，net
MoveTo 1050, 500
LeftClick 1
Delay 2000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 2000

End If

//************************妖精指令************************

FindPic 0, 0, 1366, 768, "E:\按键精灵\按键精灵2014\screen\空指令.bmp", 1, intX, intY
If intX > 0 And intY > 0 Then 
t = 0
Else 
t = 1
End If

If t = 1 and Form1.CheckBox1.Value = 1 Then 
	
//选择指挥部部署打手队
MoveTo 680, 350
LeftClick 1
Delay 1000

//妖精指令，net
MoveTo 1140, 390
LeftClick 1
Delay 1000
MoveTo 680, 350
LeftClick 1
Delay 2500

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

End If

//************************计划模式************************
//************************执行计划************************

//选择计划
MoveTo 250, 530
LeftClick 1
Delay 1000

//选择打手队
MoveTo 680, 350
LeftClick 1
Delay 1000

//选择点1
MoveTo 520, 250
LeftClick 1
Delay 1000

//上划地图
MoveTo 970, 420
Delay 200
For 10
MouseWheel 1
Delay 500
Next

//选择点2
MoveTo 545, 605
LeftClick 1
Delay 1000

//选择点3
MoveTo 700, 450
LeftClick 1
Delay 1000

//选择点4
MoveTo 550, 350
LeftClick 1
Delay 1000

//执行计划
MoveTo 1099, 577
LeftClick 1
Delay 1000

//等待推图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束021.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

Delay 10000

//结束回合
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束021.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 1070, 580
LeftClick 1
End If
Loop While i = 0

Delay 10000

//等待读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

Delay 10000

//等待读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
End If
Loop While i = 0

//************************妖精指令************************

FindPic 0, 0, 1366, 768, "E:\按键精灵\按键精灵2014\screen\空指令.bmp", 1, intX, intY
If intX > 0 And intY > 0 Then 
t = 0
Else 
t = 1
End If

If t = 1 and Form1.CheckBox1.Value = 1 Then 

//选择打手队
MoveTo 690, 350
LeftClick 1
Delay 1000

//妖精指令，net
MoveTo 1140, 390
LeftClick 1
Delay 1000
MoveTo 690, 350
LeftClick 1
Delay 2500
End If

//选择计划
MoveTo 250, 530
LeftClick 1
Delay 1000

//选择打手队
MoveTo 690, 350
LeftClick 1
Delay 1000


//确认选中
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\0-2-3.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
//选择计划
MoveTo 250, 530
LeftClick 1
Delay 1000
//选择打手队
MoveTo 690, 350
LeftClick 1
Delay 1000
Delay 1000
End If
Loop While i=0


//选择点5
MoveTo 980, 350
LeftClick 1
Delay 1000

//选择点6
MoveTo 1140, 385
LeftClick 1
Delay 1000

//执行计划
MoveTo 1099, 577
LeftClick 1
Delay 1000

Delay 40000

//结束回合
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\行动结束022.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
LeftClick 1
Delay 1000
End If
Loop While i = 0

//成果结算
Delay 5000

Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\结算S.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 2000
End If
Loop While i = 0

Delay 2000
MoveTo 699, 365
LeftClick 1
Delay 1500
LeftClick 1
Delay 500
LeftClick 1
Delay 500
LeftClick 1
Delay 500


//************************继续刷图************************

Delay 9000

//选择0-2
MoveTo 750, 365
LeftClick 1
Delay 1000

//确认是0-2
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\02.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Else 
MoveTo 360, 145
LeftClick 1
Delay 1000
MoveTo 750, 365
LeftClick 1
Delay 1500
End If
Loop While i = 0

//进入战斗
MoveTo 711, 505
LeftClick 1
Delay 5000

//确认进图完毕
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\进图完毕.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i=1
Else 
i=0
End If
Loop While i=0

End Sub





//*************************************************其他任务子程序***********其他任务子程序***********其他任务子程序*******************************************************************
//*************************************************其他任务子程序***********其他任务子程序***********其他任务子程序*******************************************************************
//*************************************************其他任务子程序***********其他任务子程序***********其他任务子程序*******************************************************************

//************************************************收每日奖励 ************************************************

Sub 收每日奖励

Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\每日奖励.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

//重磅热点，系统公告返回
MoveTo 300, 125
LeftClick 1
Delay 1500
MoveTo 280, 135
LeftClick 1
Delay 3000
//关闭奖励
MoveTo 695, 475
LeftClick 1
Delay 3000
//关闭活动窗口
MoveTo 255, 140
LeftClick 1
Delay 3000

End Sub

//******************************偷电池******************************

Sub 偷电池

If StealBattery = False Then 

//选择好友
MoveTo 1060, 600
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\好友.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 2000
End If
Loop While i = 0
//选择排序
MoveTo 950, 200
LeftClick 1
Delay 1000
MoveTo 1100, 380
LeftClick 1
Delay 1000
//进宿舍
MoveTo 430, 280
LeftClick 1
Delay 1000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\名片.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
MoveTo 930, 550
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回宿舍.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//偷电
For 12
MoveTo 440, 410
LeftClick 1
Delay 1000
MoveTo 700, 480
LeftClick 1
Delay 1000
MoveTo 1090, 600
LeftClick 1
Delay 1000
MoveTo 365, 585
LeftClick 1
Delay 6000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\返回宿舍.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
Next
//返回宿舍
MoveTo 265, 120
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\离开宿舍.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//离开宿舍
MoveTo 265, 120
LeftClick 1
Delay 3000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\基地.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0

StealBattery = True

End If

End Sub

//******************************打模拟******************************
//******************************打模拟******************************
//******************************打模拟******************************

Sub 打模拟

//选择战斗,net
MoveTo 850, 430
LeftClick 1
Delay 4500

//选择模拟任务
Do
i = 0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\战斗页面.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
MoveTo 280, 335
LeftClick 1
Delay 1000
Else 
MoveTo 850, 430
LeftClick 1
Delay 4500
End If
Loop While i = 0

//周二五日（361）打资料
MyWeekDay = Weekday(Date)
If MyWeekDay = 3 or MyWeekDay = 6 or MyWeekDay = 1 Then 
//选资料（默认中级）
MoveTo 400, 270
LeftClick 1
Delay 1000

//中级
MoveTo 775, 390
LeftClick 1
Delay 1000
/*
//初级
MoveTo 775, 305
LeftClick 1
Delay 1000

//高级
MoveTo 775, 480
LeftClick 1
Delay 1000
*/
//进入战斗
MoveTo 890, 520
LeftClick 1
Delay 1000
//确认
MoveTo 770, 450
LeftClick 1
Delay 15000
//等待胜利
LeftClick 1
Delay 9000
//返回基地
MoveTo 260, 125
LeftClick 1
Delay 9000

//其他时候打碎片
Else 
///选碎片
MoveTo 400, 430
LeftClick 1
Delay 1000
//高级
MoveTo 775, 485
LeftClick 1
Delay 1000
//读图
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\高模碎片.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//选择机场
MoveTo 685, 360
LeftClick 1
Delay 1000
//选择默认梯队3
MoveTo 250, 430
LeftClick 1
Delay 1000
//确认
MoveTo 1080, 570
LeftClick 1
Delay 1000
//开始作战
MoveTo 1080, 570
LeftClick 1
Delay 1000
//确认
MoveTo 770, 450
LeftClick 1
Delay 6000
//读图
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\高模碎片.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
//缩放
MoveTo 699, 365
KeyDown "Ctrl", 1
For 6
MouseWheel - 1 
Delay 1000
Next
KeyUp "Ctrl", 1
End If
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\高模碎片s.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
End If
Loop While i = 0
//计划模式
MoveTo 250, 530
LeftClick 1
Delay 1000
//选择打手
MoveTo 670, 445
LeftClick 1
Delay 1000
//选择点1
MoveTo 475, 445
LeftClick 1
Delay 1000
//选择点2
MoveTo 475, 250
LeftClick 1
Delay 1000
//选择点3
MoveTo 950, 250
LeftClick 1
Delay 1000
//上划
MoveTo 699, 365
Delay 200
For 4
MouseWheel 1
Delay 500
Next
//选择点4
MoveTo 950, 235
LeftClick 1
Delay 1000
//选择点5
MoveTo 720, 235
LeftClick 1
Delay 1000
//执行任务 
MoveTo 1080, 570
LeftClick 1
Delay 9000
//等待战役胜利
Do
i=0
FindPic 0,0,1366,768,"E:\按键精灵\按键精灵2014\screen\胜利.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
i = 1
Delay 9000
End If
Loop While i = 0
//返回基地
MoveTo 270, 140
LeftClick 1
Delay 9000

End If

End Sub

